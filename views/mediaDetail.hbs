{{! views/mediaDetail.hbs }}
<div class="media-detail-page">
    {{!-- Background Image / Banner --}}
    {{#if item.bannerImageUrl}}
        {{!-- Use the fetched banner image --}}
        <div class="backdrop-image" style="background-image: url('{{item.bannerImageUrl}}');"></div>
    {{else}}
         {{!-- Fallback to placeholder if no banner URL --}}
         <div class="backdrop-image placeholder"></div>
    {{/if}}

    <div class="detail-content container">
        {{!-- Main Info Section (Keep As Is) --}}
        <section class="detail-main-info">
            <div class="detail-poster">
                <img src="{{defaultIfEmpty item.imageUrl '/images/placeholder.png'}}" alt="{{item.title}} Poster" onerror="this.onerror=null; this.src='/images/placeholder.png';">
            </div>
            <div class="detail-text">
                <h1>{{item.title}} {{#if item.releaseYear}}({{item.releaseYear}}){{/if}}</h1>
                <p class="detail-subtitle">{{item.subtitle}}</p>
                <div class="detail-meta">
                    <span class="tag tag-{{classify item.mediaType}}">{{capitalize item.mediaType}}</span>
                    {{#if item.genres.length}}<span>{{join item.genres ", "}}</span>{{/if}}
                     {{#if item.runtime}}<span>{{item.runtime}}</span>{{/if}}
                     {{#if item.releaseDate}}<span>Released: {{formatDate item.releaseDate}}</span>{{/if}}
                </div>
                <div class="detail-actions">
                     {{> userInteractionControls item=item user=user}}
                </div>
                <h3>Overview</h3>
                <p class="detail-description">{{defaultIfEmpty item.description "No description available."}}</p>
            </div>
        </section>

         {{!-- Metadata Section (Keep As Is) --}}
        <section class="detail-metadata card">
            {{!-- ... existing metadata content ... --}}
        </section>

        {{!-- Trailer Section (NEW) --}}
        {{#if item.trailerVideoId}}
        <section class="detail-trailer-section card">
            <h3>Trailer</h3>
            <div class="video-responsive">
                <iframe
                    width="560" height="315"
                    src="https://www.youtube.com/embed/{{item.trailerVideoId}}"
                    title="YouTube video player for {{item.title}}"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen>
                </iframe>
            </div>
        </section>
        {{/if}}

        {{!-- Cast/Characters Section --}}
         {{#if item.cast.length}}
         <section class="detail-cast-section card">
             <h3>Cast</h3>
              <div class="swiper cast-swiper">
                 <div class="swiper-wrapper">
                     {{#each item.cast}}
                         <div class="swiper-slide cast-member">
                             <img src="{{#if profilePath}}https://image.tmdb.org/t/p/w185{{profilePath}}{{else}}/images/placeholder_avatar.png{{/if}}" alt="{{name}}" loading="lazy" onerror="this.src='/images/placeholder_avatar.png';">
                             <p class="cast-name">{{name}}</p>
                             <p class="cast-character">{{character}}</p>
                         </div>
                     {{/each}}
                 </div>
                 <div class="swiper-button-prev"></div>
                 <div class="swiper-button-next"></div>
             </div>
         </section>
         {{/if}}


        {{!-- Related Media Section (Placeholder Data) --}}
        {{#if relatedMedia.length}}
        <section class="media-carousel-section card">
            <h3 class="section-title">Related Media</h3>
            <div class="swiper media-swiper">
                <div class="swiper-wrapper">
                     {{#each relatedMedia}}
                     <div class="swiper-slide">
                         {{> mediaCard items=(list this) }}
                      </div>
                     {{/each}}
                </div>
                 <div class="swiper-button-prev"></div>
                 <div class="swiper-button-next"></div>
            </div>
        </section>
        {{/if}}

        {{!-- Reviews Section (Placeholder) --}}
        <section class="detail-reviews-section card">
            <h3>Reviews (Coming Soon)</h3>
            <p class="placeholder-text">User reviews will appear here.</p>
             {{!-- Example Review structure --}}
             {{#each reviews}}
             <div class="review-item"> ... </div>
             {{/each}}
        </section>

    </div>
</div>
